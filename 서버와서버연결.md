두 물리적 서버를 랜선으로 연결한 경우 가상 IP 를 할당하여 서버간의 데이터 통신을 직접 하는 방법의 설정 방법

### 순서

예: 서버A 에 10.10.10.1 할당 (user = usera) / 서버B 에 10.10.10.2 할당 (user = userb)

1. NIC 이름 확인
   랜선을 끼웠다 뽑았다 반복하면서 어떤 네트워크 이름인지 확인

   ```bash
   ip -br addr
   ip link show # 이름만 확인하고 싶을 때
   ```

2. 가상 IP 할당
   ```bash
   ip addr add 10.10.10.1/24 dev <NIC명칭>
   ip addr del 10.10.10.1/24 dev <NIC명칭> # 기존 할당 IP 를 삭제
   ```

3. 위의 과정을 서버 A, B 각각에서 진행

4. 연결 확인
   ```bash
   ping 10.10.10.2 # 서버A 에서 서버B
   ping 10.10.10.1 # 서버B 에서 서버A
   ```

5. 서버 A 에서 데이터 전송
   ```bash
   rsync -avP /data/test userb@10.10.10.2:/home/data
   ```

### 에러

만약 no route to host 가 뜨는 경우 아래 방법 시도

1. 서브넷 마스크가 불일치한 경우
   ```bash
   # 서버 A
   10.10.10.1/24
   # 서버 B
   10.10.10.2/32
   ```

   IP 확인 후 재할당 진행
   ```bash
   ip addr show <NIC명칭>
   ```

2. NIC 가 DOWN 인 경우
   ```bash
   ip link show <NIC명칭>
   ```

   down 으로 되어있으면 UP 으로 변경
   ```bash
   ip link set <NIC명칭> up
   ```

3. NIC 를 잘못 선택한 경우
   예: eno2 에 할당했어야 하는데 eno1 에 할당 된 경우

4. ARP 캐시가 꼬인 경우

   - 확인
     ```bash
     ip neigh
     ```

   - 해결
     ```bash
     ip neigh flush dev <NIC명칭>
     ```

     

